<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CRReservation.WEB</title>
    <base href="/" />

    <!-- Bootstrap CSS z COMMON -->
    <link rel="stylesheet" href="_content/CRReservation.COMMON/css/bootstrap/bootstrap.min.css" />

    <!-- App CSS z COMMON -->
    <link href="_content/CRReservation.COMMON/css/app.css" rel="stylesheet" />

    <!-- CSS Isolation - style scoped dla komponent贸w z COMMON -->
    <link href="_content/CRReservation.COMMON/CRReservation.COMMON.bundle.scp.css" rel="stylesheet" />

    <!-- CSS Isolation - style scoped dla komponent贸w z WEB (jeli istniej) -->
    <link href="CRReservation.WEB.styles.css" rel="stylesheet" />

    <style>
        /* Loading spinner - tylko gdy app si aduje */
        #app:empty {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #1b6ec2;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* FIX: Wymuszenie widocznoci sidebaru na wikszych ekranach */
        @media (min-width: 641px) {
            .nav-scrollable {
                display: block !important;
            }
        }

        /* FIX: Layout dla page - flex row zamiast column */
        .page {
            position: relative;
            display: flex;
            flex-direction: row !important;
            min-height: 100vh;
        }

        /* FIX: Sidebar powinien by po lewej */
        .sidebar {
            background-image: linear-gradient(180deg, rgb(5, 39, 103) 0%, #3a0647 70%) !important;
            width: 250px !important;
            height: 100vh !important;
            position: sticky !important;
            top: 0 !important;
        }

        /* FIX: Main content */
        main {
            flex: 1 !important;
        }
    </style>
</head>

<body>
    <div id="app">
        <div style="text-align: center;">
            <div class="loading-spinner" style="margin: 0 auto;"></div>
            <p style="margin-top: 20px; color: #1b6ec2;">adowanie aplikacji...</p>
        </div>
    </div>

    <div id="blazor-error-ui">
        <strong>锔 Wystpi bd:</strong>
        <div id="blazor-error-details" style="margin-top: 10px; font-family: monospace; font-size: 12px;">
            An unhandled error has occurred.
        </div>
        <div style="margin-top: 10px;">
            <a href="" class="reload" style="margin-right: 10px;"> Reload</a>
            <a class="dismiss" style="cursor: pointer;"> Dismiss</a>
        </div>
    </div>

    <script src="_framework/blazor.webassembly.js"></script>

    <script>
        // Szczeg贸owe logowanie bd贸w
        window.addEventListener('error', function (event) {
            console.error(' JavaScript Error:', event.error);
            showDetailedError(event.error);
        });

        window.addEventListener('unhandledrejection', function (event) {
            console.error(' Promise Rejection:', event.reason);
            showDetailedError(event.reason);
        });

        function showDetailedError(error) {
            const errorUI = document.getElementById('blazor-error-ui');
            const errorDetails = document.getElementById('blazor-error-details');

            if (errorUI && errorDetails) {
                let errorMessage = '';

                if (error) {
                    errorMessage += 'Message: ' + (error.message || error.toString()) + '\n\n';

                    if (error.stack) {
                        errorMessage += 'Stack Trace:\n' + error.stack;
                    }
                }

                errorDetails.textContent = errorMessage;
                errorUI.style.display = 'block';
            }
        }

        // Dismiss button handler
        document.addEventListener('DOMContentLoaded', function () {
            const dismissBtn = document.querySelector('#blazor-error-ui .dismiss');
            if (dismissBtn) {
                dismissBtn.addEventListener('click', function () {
                    document.getElementById('blazor-error-ui').style.display = 'none';
                });
            }
        });

        console.log(' Blazor WebAssembly starting...');
        console.log(' Looking for CSS at: _content/CRReservation.COMMON/css/');
    </script>
</body>

</html>